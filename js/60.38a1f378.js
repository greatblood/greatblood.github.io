"use strict";(self["webpackChunkcheck_work_view"]=self["webpackChunkcheck_work_view"]||[]).push([[60],{344:function(e,t,l){l.d(t,{Bv:function(){return w},HD:function(){return c},Li:function(){return u},Ll:function(){return n},bR:function(){return _},dv:function(){return a},fM:function(){return o},h8:function(){return m},kn:function(){return r},x4:function(){return i},zd:function(){return d}});var s=l(8676);function i(e){return(0,s.Z)({url:"/student/login",method:"post",data:e})}function a(e){return(0,s.Z)({url:"/student/student/create",method:"post",data:e})}function o(){return(0,s.Z)({url:"/student/getByToken",method:"get",params:{},data:{}})}function n(){return(0,s.Z)({url:"/dashboard/student",method:"get",params:{},data:{}})}function r(e){return(0,s.Z)({url:"/work/course/find/student",method:"get",params:e,data:{}})}function u(e){return(0,s.Z)({url:"/work/course/join",method:"post",params:{},data:e})}function d(e){return(0,s.Z)({url:"/work/course/exitByStudent",method:"delete",params:e,data:{}})}function m(e){return(0,s.Z)({url:"/work/work/find",method:"get",params:e,data:{}})}function c(e){return(0,s.Z)({url:"/work/work/upload",method:"post",data:e})}function w(e){return(0,s.Z)({url:"/work/work/answer/details",method:"get",params:e,data:{}})}function _(e){return(0,s.Z)({url:"/manager/class/find",method:"get",params:e})}},5060:function(e,t,l){l.r(t),l.d(t,{default:function(){return C}});var s=l(3396),i=l(7139);const a=e=>((0,s.dD)("data-v-15a296f2"),e=e(),(0,s.Cn)(),e),o={class:"cell-item"},n={class:"cell-item"},r={class:"cell-item"},u={class:"cell-item"},d={class:"cell-item"},m={class:"cell-item"},c={class:"cell-item"},w=a((()=>(0,s._)("div",{class:"el-upload__tip"}," jpg/png files with a size less than 500KB. ",-1))),_=["src"],p={class:"cell-item"},f={class:"cell-item"},k={class:"cell-item"},h={class:"cell-item"},g={class:"cell-item"},y={class:"cell-item"},U={class:"cell-item"},W={style:{float:"right"}},v={class:"cell-item"},b={class:"demo-image__preview"};function z(e,t,l,a,z,j){const S=(0,s.up)("user"),L=(0,s.up)("el-icon"),F=(0,s.up)("el-descriptions-item"),q=(0,s.up)("iphone"),P=(0,s.up)("location"),Z=(0,s.up)("tickets"),C=(0,s.up)("el-tag"),V=(0,s.up)("office-building"),x=(0,s.up)("el-descriptions"),D=(0,s.up)("el-card"),T=(0,s.up)("el-radio-button"),$=(0,s.up)("el-radio-group"),M=(0,s.up)("el-form-item"),B=(0,s.up)("el-input"),H=(0,s.up)("el-button"),I=(0,s.up)("el-upload"),Y=(0,s.up)("Plus"),R=(0,s.up)("el-dialog"),A=(0,s.up)("el-form"),K=(0,s.up)("Document"),E=(0,s.up)("el-image");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(D,null,{default:(0,s.w5)((()=>[(0,s.Wm)(x,{class:"margin-top",title:"作业信息",column:2,size:e.size,border:""},{default:(0,s.w5)((()=>[(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",o,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(S)])),_:1},8,["style"]),(0,s.Uk)(" 题目 ")])])),default:(0,s.w5)((()=>[(0,s.Uk)(" "+(0,i.zw)(z.work.title_name),1)])),_:1}),(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",n,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(q)])),_:1},8,["style"]),(0,s.Uk)(" 出题老师 ")])])),default:(0,s.w5)((()=>[(0,s.Uk)(" "+(0,i.zw)(z.work.teacher_name),1)])),_:1}),(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",r,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(P)])),_:1},8,["style"]),(0,s.Uk)(" 课程 ")])])),default:(0,s.w5)((()=>[(0,s.Uk)(" "+(0,i.zw)(z.work.course_name),1)])),_:1}),(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",u,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(Z)])),_:1},8,["style"]),(0,s.Uk)(" 状态 ")])])),default:(0,s.w5)((()=>[z.nowTime<z.work.start_time?((0,s.wg)(),(0,s.j4)(C,{key:0,type:"danger",size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" 未开始")])),_:1})):(0,s.kq)("",!0),z.nowTime>z.work.start_time&&z.nowTime<z.work.end_time?((0,s.wg)(),(0,s.j4)(C,{key:1,type:"success",size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" 进行中")])),_:1})):(0,s.kq)("",!0),z.nowTime>z.work.end_time?((0,s.wg)(),(0,s.j4)(C,{key:2,type:"warning",size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" 已结束")])),_:1})):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",d,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(V)])),_:1},8,["style"]),(0,s.Uk)(" 开始时间 ")])])),default:(0,s.w5)((()=>[(0,s.Uk)(" "+(0,i.zw)(z.work.start_time),1)])),_:1}),(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",m,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(Z)])),_:1},8,["style"]),(0,s.Uk)(" 结束时间 ")])])),default:(0,s.w5)((()=>[(0,s.Uk)(" "+(0,i.zw)(z.work.end_time),1)])),_:1})])),_:1},8,["size"]),(0,s.Wm)(x,{direction:"vertical",column:1,size:e.size,border:""},{default:(0,s.w5)((()=>[(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",c,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(V)])),_:1},8,["style"]),(0,s.Uk)(" 内容 ")])])),default:(0,s.w5)((()=>[(0,s._)("pre",null,(0,i.zw)(z.work.title_content),1)])),_:1})])),_:1},8,["size"])])),_:1}),z.isUploadok?((0,s.wg)(),(0,s.j4)(D,{key:0,class:"up"},{default:(0,s.w5)((()=>[(0,s.Wm)(A,{model:z.operaForm,"label-width":"120px"},{default:(0,s.w5)((()=>[(0,s.Wm)(M,{label:"上传方式"},{default:(0,s.w5)((()=>[(0,s.Wm)($,{modelValue:z.mode,"onUpdate:modelValue":t[0]||(t[0]=e=>z.mode=e),size:"large"},{default:(0,s.w5)((()=>[(0,s.Wm)(T,{label:"上传文字"}),(0,s.Wm)(T,{label:"上传文件"}),(0,s.Wm)(T,{label:"上传图片"})])),_:1},8,["modelValue"])])),_:1}),"上传文字"==z.mode?((0,s.wg)(),(0,s.j4)(M,{key:0,label:"文字答案"},{default:(0,s.w5)((()=>[(0,s.Wm)(B,{modelValue:z.operaForm.content,"onUpdate:modelValue":t[1]||(t[1]=e=>z.operaForm.content=e),type:"textarea"},null,8,["modelValue"])])),_:1})):(0,s.kq)("",!0),"上传文件"==z.mode?((0,s.wg)(),(0,s.j4)(M,{key:1,label:"上传文件"},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{"file-list":z.fileList,"onUpdate:fileList":t[2]||(t[2]=e=>z.fileList=e),name:"work_file",action:"http://127.0.0.1:11002/work/work/upload/file",headers:z.headers,limit:1,multiple:"","on-success":j.uploadfileSuccess},{tip:(0,s.w5)((()=>[w])),default:(0,s.w5)((()=>[(0,s.Wm)(H,{type:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("上传作业文件")])),_:1})])),_:1},8,["file-list","headers","on-success"])])),_:1})):(0,s.kq)("",!0),"上传图片"==z.mode?((0,s.wg)(),(0,s.j4)(M,{key:2,label:"上传图片"},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{"file-list":z.PicList,"onUpdate:fileList":t[3]||(t[3]=e=>z.PicList=e),name:"work_file",action:"http://127.0.0.1:11002/work/work/upload/file",headers:z.headers,limit:5,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-success":j.uploadSuccess,"on-remove":e.handleRemove},{default:(0,s.w5)((()=>[(0,s.Wm)(L,null,{default:(0,s.w5)((()=>[(0,s.Wm)(Y)])),_:1})])),_:1},8,["file-list","headers","on-preview","on-success","on-remove"]),(0,s.Wm)(R,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=t=>e.dialogVisible=t)},{default:(0,s.w5)((()=>[(0,s._)("img",{"w-full":"",src:e.dialogImageUrl,alt:"Preview Image"},null,8,_)])),_:1},8,["modelValue"])])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(M,null,{default:(0,s.w5)((()=>[(0,s.Wm)(H,{type:"primary",onClick:j.onSubmit},{default:(0,s.w5)((()=>[(0,s.Uk)("提交作业")])),_:1},8,["onClick"]),(0,s.Wm)(H,{type:"primary",onClick:j.notUpdate},{default:(0,s.w5)((()=>[(0,s.Uk)("返回")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1})):(0,s.kq)("",!0),z.isUpload?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(D,{key:1,class:"up"},{default:(0,s.w5)((()=>[(0,s.Wm)(x,{class:"margin-top",title:"回答信息",column:2,size:e.size,border:""},{extra:(0,s.w5)((()=>[(0,s.Wm)(H,{type:"primary",onClick:t[5]||(t[5]=e=>j.updateWork())},{default:(0,s.w5)((()=>[(0,s.Uk)("修改答案")])),_:1})])),default:(0,s.w5)((()=>[(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",p,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(S)])),_:1},8,["style"]),(0,s.Uk)(" 题目 ")])])),default:(0,s.w5)((()=>[(0,s.Uk)(" "+(0,i.zw)(z.work.title_name),1)])),_:1}),(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",f,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(q)])),_:1},8,["style"]),(0,s.Uk)(" 上传方式 ")])])),default:(0,s.w5)((()=>[(0,s.Uk)(" "+(0,i.zw)(z.answer.content_msg.work_type),1)])),_:1}),(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",k,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(P)])),_:1},8,["style"]),(0,s.Uk)(" 首次上传时间 ")])])),default:(0,s.w5)((()=>[(0,s.Uk)(" "+(0,i.zw)(z.answer.create_time),1)])),_:1}),(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",h,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(Z)])),_:1},8,["style"]),(0,s.Uk)(" 修改时间 ")])])),default:(0,s.w5)((()=>[(0,s.Uk)(" "+(0,i.zw)(z.answer.update_time),1)])),_:1}),(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",g,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(V)])),_:1},8,["style"]),(0,s.Uk)(" 作业查重情况 ")])])),default:(0,s.w5)((()=>[-2==z.answer.hamming_distance?((0,s.wg)(),(0,s.j4)(C,{key:0,size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)("待查重")])),_:1})):(0,s.kq)("",!0),-1==z.answer.hamming_distance?((0,s.wg)(),(0,s.j4)(C,{key:1,type:"success",size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)("没有重复")])),_:1})):(0,s.kq)("",!0),z.answer.hamming_distance>-1&&z.answer.hamming_distance<4?((0,s.wg)(),(0,s.j4)(C,{key:2,type:"danger",size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" 海明距离："+(0,i.zw)(z.answer.hamming_distance),1)])),_:1})):(0,s.kq)("",!0),z.answer.hamming_distance>3?((0,s.wg)(),(0,s.j4)(C,{key:3,type:"warning",size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(z.answer.hamming_distance),1)])),_:1})):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",y,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(Z)])),_:1},8,["style"]),(0,s.Uk)(" 状态 ")])])),default:(0,s.w5)((()=>[1==z.answer.check_state?((0,s.wg)(),(0,s.j4)(C,{key:0,size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)("待查重")])),_:1})):(0,s.kq)("",!0),2==z.answer.check_state?((0,s.wg)(),(0,s.j4)(C,{key:1,type:"success",size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)("已查重")])),_:1})):(0,s.kq)("",!0)])),_:1})])),_:1},8,["size"]),e.isUploadFile?((0,s.wg)(),(0,s.j4)(x,{key:0,direction:"vertical",column:1,size:e.size,border:""},{default:(0,s.w5)((()=>[(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",U,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(V)])),_:1},8,["style"]),(0,s.Uk)(" 文件 ")])])),default:(0,s.w5)((()=>[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(K)])),_:1},8,["style"]),(0,s.Uk)(" "+(0,i.zw)(z.answer.content_msg.file_name)+" ",1),(0,s._)("div",W,[(0,s.Wm)(H,{type:"primary",onClick:t[6]||(t[6]=e=>j.downloadFile())},{default:(0,s.w5)((()=>[(0,s.Uk)("下载")])),_:1})])])),_:1})])),_:1},8,["size"])):(0,s.kq)("",!0),e.isUploadPic?((0,s.wg)(),(0,s.j4)(x,{key:1,direction:"vertical",column:1,size:e.size,border:""},{default:(0,s.w5)((()=>[(0,s.Wm)(F,null,{label:(0,s.w5)((()=>[(0,s._)("div",v,[(0,s.Wm)(L,{style:(0,i.j5)(e.iconStyle)},{default:(0,s.w5)((()=>[(0,s.Wm)(V)])),_:1},8,["style"]),(0,s.Uk)(" 图片 ")])])),default:(0,s.w5)((()=>[(0,s._)("div",b,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(z.answer.content_msg.pic_url,(e=>((0,s.wg)(),(0,s.j4)(E,{style:{width:"100px",height:"100px","margin-left":"20px"},src:e,"preview-src-list":[e],"initial-index":4,fit:"cover"},null,8,["src","preview-src-list"])))),256))])])),_:1})])),_:1},8,["size"])):(0,s.kq)("",!0)])),_:1}))])}l(7658);var j=l(6797),S=l.n(j),L=l(4161),F=l(344),q={data(){return{work:{},tableData:[],isUpload:!0,isUploadok:!1,isUpdate:!1,nowTime:S()().format("YYYY-MM-DD HH:mm:ss"),fileList:[],PicList:[],mode:"上传文字",operaForm:{pic_url:[]},headers:{token:sessionStorage.getItem("token"),user_id:sessionStorage.getItem("user_id")},answer:{hamming_distance:"",hash_64:"",create_time:"",update_time:"",content_msg:{content:"",file_name:"",file_url:"",pic_url:[],work_type:0}}}},created(){this.getUserMessage(),this.getAnswerMessage()},methods:{async getUserMessage(){var e=this.$route.query.work_id;(0,F.h8)({work_id:e}).then((e=>{200!=e.data.code?this.$message.error(e.data.msg):this.work=e.data.data.data[0],this.nowTime>this.work.start_time&&this.nowTime<this.work.end_time&&this.isUpload&&(this.isUploadok=!0)}))},async getAnswerMessage(){var e=this.$route.query.work_id;console.log(e),(0,F.Bv)({work_id:e}).then((e=>{if(console.log(e),200!=e.data.code);else{var t=e.data.data;1==t.content_msg.work_type&&(t.content_msg.work_type="上传文字",this.isUploadFile=!1,this.isUploadPic=!1),2==t.content_msg.work_type&&(t.content_msg.work_type="上传文件",this.isUploadFile=!0,this.isUploadPic=!1),3==t.content_msg.work_type&&(t.content_msg.work_type="上传图片",this.isUploadFile=!1,this.isUploadPic=!0),this.answer=t,this.isUpload=!1,this.isUploadok=!1}}))},uploadSuccess(e,t){if(200!=e.code)this.PicList.pop(),this.$message({showClose:!0,message:e.msg,type:"error"});else{var l={name:t.name,url:t.response.data};this.PicList.pop(),this.PicList.push(l),this.$message({showClose:!0,message:"上传成功",type:"success"})}},uploadfileSuccess(e,t){var l={name:t.name,url:t.response.data};this.fileList.pop(),this.fileList.push(l),this.$message({showClose:!0,message:"上传成功",type:"success"})},downloadFile(){var e=this.answer.content_msg.file_url,t=this.answer.content_msg.file_name;L.Z.get(this.answer.content_msg.file_url),(0,L.Z)({method:"get",url:e,responseType:"blob"}).then((function(e){const l=document.createElement("a");let s=new Blob([e.data],{type:e.data.type}),i=URL.createObjectURL(s);l.href=i,l.download=t,l.click()}))},updateWork(){if(console.log(this.answer),this.answer.content_msg.file_url.length>0){var e=[{name:this.answer.content_msg.file_name,url:this.answer.content_msg.file_url}];this.fileList=e}var t=[],l=this.answer.content_msg.pic_url;for(let i=0;i<l.length;i++){var s={url:l[i]};t.push(s)}this.PicList=t,this.isUpload=!0,this.isUploadok=!0},notUpdate(){this.operaForm={},this.isUpload=!1,this.isUploadok=!1},onSubmit(){if(this.operaForm.title_to_publish_id=this.work._id,"上传文字"==this.mode)this.operaForm.work_type=1;else if("上传文件"==this.mode)this.operaForm.work_type=2;else{if("上传图片"!=this.mode)return void this.$message.error("请选择上传方式");this.operaForm.work_type=3}this.fileList.length>0&&(this.operaForm.file_url=this.fileList[0].url,this.operaForm.file_name=this.fileList[0].name),this.operaForm.pic_url=[];for(let t=0;t<this.PicList.length;t++){var e=this.PicList[t].url;this.operaForm.pic_url.push(e)}(0,F.HD)(this.operaForm).then((e=>{200!=e.data.code?this.$message.error(e.data.msg):(this.$message({message:"上传作业成功",type:"success"}),this.getAnswerMessage())}))}}},P=l(89);const Z=(0,P.Z)(q,[["render",z],["__scopeId","data-v-15a296f2"]]);var C=Z}}]);
//# sourceMappingURL=60.38a1f378.js.map