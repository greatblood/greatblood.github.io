"use strict";(self["webpackChunkcheck_work_view"]=self["webpackChunkcheck_work_view"]||[]).push([[1],{7851:function(e,t,a){a.d(t,{DT:function(){return R},F:function(){return n},Q1:function(){return C},XG:function(){return u},Yy:function(){return D},Z9:function(){return h},cY:function(){return d},eb:function(){return b},f5:function(){return _},fM:function(){return r},h8:function(){return k},hJ:function(){return W},oW:function(){return y},qe:function(){return c},sH:function(){return s},sw:function(){return i},t8:function(){return p},tQ:function(){return m},vm:function(){return F},vn:function(){return g},x4:function(){return o},yT:function(){return U},yw:function(){return f},zd:function(){return w}});var l=a(8676);function o(e){return(0,l.Z)({url:"/teacher/login",method:"post",params:{},data:e})}function r(){return(0,l.Z)({url:"/teacher/getByToken",method:"get",params:{},data:{}})}function s(e){return(0,l.Z)({url:"/work/title/create",method:"post",params:{},data:e})}function n(e){return(0,l.Z)({url:"/work/title/delete",method:"delete",params:e,data:{}})}function i(e){return(0,l.Z)({url:"/work/title/update",method:"put",params:{},data:e})}function u(e){return(0,l.Z)({url:"/work/title/find",method:"get",params:e,data:{}})}function d(e){return(0,l.Z)({url:"/work/title/details",method:"get",params:e,data:{}})}function m(e){return(0,l.Z)({url:"/work/title/publish",method:"post",params:{},data:e})}function c(e){return(0,l.Z)({url:"/work/course/create",method:"post",params:{},data:e})}function p(e){return(0,l.Z)({url:"/work/course/delete",method:"delete",params:e,data:{}})}function h(e){return(0,l.Z)({url:"/work/course/update",method:"put",params:{},data:e})}function g(e){return(0,l.Z)({url:"/work/course/find",method:"get",params:e,data:{}})}function f(e){return(0,l.Z)({url:"/work/course/show/student",method:"get",params:e,data:{}})}function w(e){return(0,l.Z)({url:"/work/course/exitByTeacher",method:"delete",params:e,data:{}})}function _(e){return(0,l.Z)({url:"/work/course/details",method:"get",params:e,data:{}})}function k(e){return(0,l.Z)({url:"/work/work/findByTeacher",method:"get",params:e,data:{}})}function y(e){return(0,l.Z)({url:"/work/work/show/student",method:"get",params:e,data:{}})}function W(e){return(0,l.Z)({url:"/work/course/role/create",method:"post",params:{},data:e})}function b(e){return(0,l.Z)({url:"/work/course/role/delete",method:"delete",params:e,data:{}})}function C(e){return(0,l.Z)({url:"/work/course/role/update",method:"put",params:{},data:e})}function F(e){return(0,l.Z)({url:"/work/course/role/find",method:"get",params:e,data:{}})}function R(e){return(0,l.Z)({url:"/manager/function/findByCourse",method:"get",params:e})}function U(e){return(0,l.Z)({url:"/work/course/update/student/role",method:"put",params:{},data:e})}function D(e){return(0,l.Z)({url:"/work/work/answer/details/teacher",method:"get",params:e,data:{}})}},8676:function(e,t,a){a.d(t,{Z:function(){return n}});a(7658);var l=a(4161);function o(){var e={token:sessionStorage.getItem("token"),user_id:sessionStorage.getItem("user_id"),type:sessionStorage.getItem("type")};return e}var r=a(7178);const s=l.Z.create({baseURL:"https://serve.xiongmaojiuxian.eu.org"});s.interceptors.request.use((e=>{var t=o();return""!=t.token&&(e.headers["token"]=t.token,e.headers["user_id"]=t.user_id,e.headers["type"]=t.type),e}),(e=>Promise.reject(e))),s.interceptors.response.use((e=>{if(console.log(e),401===e.data.code&&(console.log(1233),(0,r.z8)({message:e.data.msg,type:"error",duration:5e3}),router.push("/login")),400!==e.data.code)return e;(0,r.z8)({message:e.data.msg,type:"error",duration:5e3})}),(e=>{Promise.reject(e)}));var n=s},4001:function(e,t,a){a.r(t),a.d(t,{default:function(){return W}});var l=a(3396),o=a(7139);const r=e=>((0,l.dD)("data-v-1d22ca34"),e=e(),(0,l.Cn)(),e),s={class:"cell-item"},n={class:"cell-item"},i={class:"cell-item"},u={class:"cell-item"},d={class:"cell-item"},m={class:"cell-item"},c={class:"cell-item"},p={key:0,style:{display:"flex","flex-direction":"row-reverse","margin-top":"10px"}},h={key:0,style:{display:"flex","flex-direction":"row-reverse","margin-top":"10px"}},g=r((()=>(0,l._)("div",{class:"el-upload__text"}," 上传学生信息文件(.csv) ",-1)));function f(e,t,a,r,f,w){const _=(0,l.up)("el-button"),k=(0,l.up)("user"),y=(0,l.up)("el-icon"),W=(0,l.up)("el-descriptions-item"),b=(0,l.up)("iphone"),C=(0,l.up)("location"),F=(0,l.up)("tickets"),R=(0,l.up)("office-building"),U=(0,l.up)("el-descriptions"),D=(0,l.up)("el-card"),v=(0,l.up)("el-input"),V=(0,l.up)("el-form-item"),z=(0,l.up)("el-form"),S=(0,l.up)("el-table-column"),x=(0,l.up)("el-option"),Z=(0,l.up)("el-select"),$=(0,l.up)("el-table"),T=(0,l.up)("el-pagination"),M=(0,l.up)("el-dialog"),j=(0,l.up)("el-tree"),H=(0,l.up)("el-drawer"),I=(0,l.up)("upload-filled"),q=(0,l.up)("el-link"),P=(0,l.up)("el-upload");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(U,{class:"margin-top",title:"课程信息",column:2,size:e.size,border:""},{extra:(0,l.w5)((()=>[(0,l.Wm)(_,{disabled:!f.isMycourse,type:"primary",onClick:w.onupdate},{default:(0,l.w5)((()=>[(0,l.Uk)("修改信息")])),_:1},8,["disabled","onClick"])])),default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{label:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l.Wm)(y,{style:(0,o.j5)(e.iconStyle)},{default:(0,l.w5)((()=>[(0,l.Wm)(k)])),_:1},8,["style"]),(0,l.Uk)(" 课程名称 ")])])),default:(0,l.w5)((()=>[(0,l.Uk)(" "+(0,o.zw)(f.course.name),1)])),_:1}),(0,l.Wm)(W,null,{label:(0,l.w5)((()=>[(0,l._)("div",n,[(0,l.Wm)(y,{style:(0,o.j5)(e.iconStyle)},{default:(0,l.w5)((()=>[(0,l.Wm)(b)])),_:1},8,["style"]),(0,l.Uk)(" 任课老师 ")])])),default:(0,l.w5)((()=>[(0,l.Uk)(" "+(0,o.zw)(f.course.teacher_name),1)])),_:1}),(0,l.Wm)(W,null,{label:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l.Wm)(y,{style:(0,o.j5)(e.iconStyle)},{default:(0,l.w5)((()=>[(0,l.Wm)(C)])),_:1},8,["style"]),(0,l.Uk)(" 院系 ")])])),default:(0,l.w5)((()=>[(0,l.Uk)(" "+(0,o.zw)(f.course.department),1)])),_:1}),(0,l.Wm)(W,null,{label:(0,l.w5)((()=>[(0,l._)("div",u,[(0,l.Wm)(y,{style:(0,o.j5)(e.iconStyle)},{default:(0,l.w5)((()=>[(0,l.Wm)(F)])),_:1},8,["style"]),(0,l.Uk)(" 年级 ")])])),default:(0,l.w5)((()=>[(0,l.Uk)(" "+(0,o.zw)(f.course.grade),1)])),_:1}),(0,l.Wm)(W,null,{label:(0,l.w5)((()=>[(0,l._)("div",d,[(0,l.Wm)(y,{style:(0,o.j5)(e.iconStyle)},{default:(0,l.w5)((()=>[(0,l.Wm)(R)])),_:1},8,["style"]),(0,l.Uk)(" 创建时间 ")])])),default:(0,l.w5)((()=>[(0,l.Uk)(" "+(0,o.zw)(f.course.create_time),1)])),_:1}),(0,l.Wm)(W,null,{label:(0,l.w5)((()=>[(0,l._)("div",m,[(0,l.Wm)(y,{style:(0,o.j5)(e.iconStyle)},{default:(0,l.w5)((()=>[(0,l.Wm)(R)])),_:1},8,["style"]),(0,l.Uk)(" 默认角色 ")])])),default:(0,l.w5)((()=>[(0,l.Uk)(" "+(0,o.zw)(f.course.default_role_name),1)])),_:1})])),_:1},8,["size"]),(0,l.Wm)(U,{direction:"vertical",column:1,size:e.size,border:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{label:(0,l.w5)((()=>[(0,l._)("div",c,[(0,l.Wm)(y,{style:(0,o.j5)(e.iconStyle)},{default:(0,l.w5)((()=>[(0,l.Wm)(R)])),_:1},8,["style"]),(0,l.Uk)(" 简介 ")])])),default:(0,l.w5)((()=>[(0,l._)("pre",null,(0,o.zw)(f.course.introduction),1)])),_:1})])),_:1},8,["size"])])),_:1}),f.isRoleManage?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(D,{key:0,class:"header"},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{inline:!0,class:"headerForm",model:f.searchHeaderForm,style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{style:{float:"left"}},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{clearable:"",modelValue:f.searchHeaderForm.find,"onUpdate:modelValue":t[0]||(t[0]=e=>f.searchHeaderForm.find=e),placeholder:"请输入名称"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(_,{style:{float:"left"},type:"primary",onClick:w.getDatas},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1},8,["onClick"]),(0,l.Uk)(" 学生管理 "),(0,l.Wm)(_,{class:"searchBtn",type:"primary",onClick:w.importStudent},{default:(0,l.w5)((()=>[(0,l.Uk)("导入学生")])),_:1},8,["onClick"]),(0,l.Wm)(_,{class:"searchBtn",type:"primary",onClick:w.managerRole},{default:(0,l.w5)((()=>[(0,l.Uk)("管理角色")])),_:1},8,["onClick"])])),_:1},8,["model"])])),_:1})),f.isRoleManage?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(D,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)($,{data:f.tableData,border:"",style:{width:"100%"},"header-cell-style":{background:"#F3F4F7",color:"#555"}},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{prop:"name",label:"学生名称","min-width":"200"}),(0,l.Wm)(S,{label:"角色","min-width":"200"},{default:(0,l.w5)((e=>[(0,l.Wm)(Z,{modelValue:e.row.role_name,"onUpdate:modelValue":t=>e.row.role_name=t,onChange:t=>w.changeRole(t,e.row._id)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.options1,(e=>((0,l.wg)(),(0,l.j4)(x,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,l.Wm)(S,{prop:"class_name",label:"班级名称","min-width":"200"}),(0,l.Wm)(S,{prop:"class_department",label:"院系","min-width":"200"}),(0,l.Wm)(S,{align:"center",fixed:"right",label:"操作",width:"200"},{default:(0,l.w5)((e=>[(0,l.Wm)(_,{type:"danger",onClick:t=>w.exit(e.row._id)},{default:(0,l.w5)((()=>[(0,l.Uk)("踢出")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),0!==f.tableData.length?((0,l.wg)(),(0,l.iD)("div",p,[(0,l.Wm)(T,{"current-page":f.currentPage,"page-size":f.pageSize,total:f.total,"page-sizes":[10,20,50,100],background:"",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])):(0,l.kq)("",!0)])),_:1})),f.isRoleManage?((0,l.wg)(),(0,l.j4)(D,{key:2,class:"header"},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{inline:!0,class:"headerForm",model:f.searchHeaderForm,style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{style:{float:"left"}},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{clearable:"",modelValue:f.searchHeaderForm.find,"onUpdate:modelValue":t[1]||(t[1]=e=>f.searchHeaderForm.find=e),placeholder:"请输入名称"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(_,{style:{float:"left"},type:"primary",onClick:w.getDatas},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1},8,["onClick"]),(0,l.Uk)(" 角色管理 "),(0,l.Wm)(_,{class:"searchBtn",type:"primary",onClick:w.submitAddRole},{default:(0,l.w5)((()=>[(0,l.Uk)("新增角色")])),_:1},8,["onClick"]),(0,l.Wm)(_,{class:"searchBtn",type:"primary",onClick:w.managerStudent},{default:(0,l.w5)((()=>[(0,l.Uk)("管理学生")])),_:1},8,["onClick"])])),_:1},8,["model"])])),_:1})):(0,l.kq)("",!0),f.isRoleManage?((0,l.wg)(),(0,l.j4)(D,{key:3},{default:(0,l.w5)((()=>[(0,l.Wm)($,{data:f.tableDataRole,border:"",style:{width:"100%"},"header-cell-style":{background:"#F3F4F7",color:"#555"}},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{prop:"name",label:"角色名称","min-width":"200"}),(0,l.Wm)(S,{prop:"create_time",label:"创建时间","min-width":"200"}),(0,l.Wm)(S,{prop:"update_time",label:"修改时间","min-width":"200"}),(0,l.Wm)(S,{align:"center",fixed:"right",label:"权限",width:"200"},{default:(0,l.w5)((e=>[(0,l.Wm)(_,{type:"primary",onClick:t=>w.upFunctions(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("设置权限")])),_:2},1032,["onClick"])])),_:1}),(0,l.Wm)(S,{align:"center",fixed:"right",label:"操作",width:"200"},{default:(0,l.w5)((e=>[(0,l.Wm)(_,{type:"primary",onClick:t=>w.submitUpdateRole("update",e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("修改")])),_:2},1032,["onClick"]),(0,l.Wm)(_,{type:"danger",onClick:t=>w.deleteRole(e.row._id)},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),0!==f.tableDataRole.length?((0,l.wg)(),(0,l.iD)("div",h,[(0,l.Wm)(T,{"current-page":f.currentPage,"page-size":f.pageSize,total:f.total,"page-sizes":[10,20,50,100],background:"",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])):(0,l.kq)("",!0)])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(M,{"modal-append-to-body":!1,modelValue:f.operaDialog,"onUpdate:modelValue":t[8]||(t[8]=e=>f.operaDialog=e),title:e.修改课程信息,onClose:w.resetFormCrouse},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{"status-icon":"",model:f.operaForm,ref:"operaForm",class:"operaDialog","label-width":"100px",rules:e.rules},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{label:"课程名称"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{modelValue:f.operaForm.name,"onUpdate:modelValue":t[2]||(t[2]=e=>f.operaForm.name=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(V,{label:"院系"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{modelValue:f.operaForm.department,"onUpdate:modelValue":t[3]||(t[3]=e=>f.operaForm.department=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(V,{label:"年级"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{modelValue:f.operaForm.grade,"onUpdate:modelValue":t[4]||(t[4]=e=>f.operaForm.grade=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(V,{label:"默认角色"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{modelValue:f.operaForm.default_role_id,"onUpdate:modelValue":t[5]||(t[5]=e=>f.operaForm.default_role_id=e),placeholder:"请选择角色",size:"large"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.options1,(e=>((0,l.wg)(),(0,l.j4)(x,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(V,{label:"简介"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{type:"textarea",modelValue:f.operaForm.introduction,"onUpdate:modelValue":t[6]||(t[6]=e=>f.operaForm.introduction=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{type:"primary",onClick:t[7]||(t[7]=e=>w.submitForm())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交")])),_:1}),(0,l.Wm)(_,{onClick:w.resetFormCrouse},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","onClose"]),(0,l.Wm)(M,{"modal-append-to-body":!1,modelValue:f.roleDialog,"onUpdate:modelValue":t[11]||(t[11]=e=>f.roleDialog=e),title:f.dialogTitle,onClose:w.resetFormRole},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{"status-icon":"",model:f.operaRoleForm,ref:"operaRoleForm",class:"roleDialog","label-width":"100px",rules:e.rules},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{label:"姓名",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{modelValue:f.operaRoleForm.name,"onUpdate:modelValue":t[9]||(t[9]=e=>f.operaRoleForm.name=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{type:"primary",onClick:t[10]||(t[10]=e=>w.submitRoleForm())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交")])),_:1}),(0,l.Wm)(_,{onClick:w.resetFormRole},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","onClose"]),(0,l.Wm)(H,{modelValue:f.drawer,"onUpdate:modelValue":t[12]||(t[12]=e=>f.drawer=e),"with-header":!1},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{class:"fl-right",type:"primary",onClick:w.upFunctionsEnter},{default:(0,l.w5)((()=>[(0,l.Uk)("确 定")])),_:1},8,["onClick"]),(0,l.Wm)(j,{ref:"functionTree",data:f.treedata,props:f.defaultProps,"default-checked-keys":f.functonsTreeIds,accordion:"","show-checkbox":"","default-expand-all":"","highlight-current":"","node-key":"_id"},null,8,["data","props","default-checked-keys"])])),_:1},8,["modelValue"]),(0,l.Wm)(M,{"modal-append-to-body":!1,modelValue:f.studentDialog,"onUpdate:modelValue":t[14]||(t[14]=e=>f.studentDialog=e),title:f.dialogTitle,onClose:w.resetFormRole},{default:(0,l.w5)((()=>[(0,l.Wm)(P,{drag:"","file-list":f.fileList,"onUpdate:fileList":t[13]||(t[13]=e=>f.fileList=e),name:"file",action:"http://127.0.0.1:11002/work/course/upload/csv",headers:f.headers,"on-success":w.uploadfileSuccess},{tip:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(q,{type:"primary",href:"http://101.200.87.232:19000/example/importStudent.xlsx"},{default:(0,l.w5)((()=>[(0,l.Uk)("模板文件下载")])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{class:"el-icon--upload"},{default:(0,l.w5)((()=>[(0,l.Wm)(I)])),_:1}),g])),_:1},8,["file-list","headers","on-success"])])),_:1},8,["modelValue","title","onClose"])])}a(7658);var w=a(7851),_={data(){return{course:{},operaForm:{},headers:{token:sessionStorage.getItem("token"),user_id:sessionStorage.getItem("user_id"),course_id:""},operaRoleForm:{},tableDataRole:[],tableData:[],isMycourse:!1,operaDialog:!1,isRoleManage:!1,roleDialog:!1,dialogTitle:"",pageSize:10,total:0,currentPage:1,searchHeaderForm:{find:""},roleOpera:"",drawer:!1,updateRole:{},treedata:[],functonsTreeIds:[],defaultProps:{children:"functions",label:"name"},options1:[],studentDialog:!1,fileList:[]}},created(){this.getUserMessage(),this.getRoleMessage(),this.getAllFunctions(),this.getDatas()},methods:{async getUserMessage(){var e=this.$route.query.course_id;(0,w.f5)({_id:e}).then((e=>{200!=e.data.code?this.$message.error(e.data.msg):(this.course=e.data.data,this.course.teacher_id==sessionStorage.getItem("user_id")&&(this.isMycourse=!0),this.headers.course_id=this.course._id)}))},async getDatas(){const e={course_id:this.$route.query.course_id,page:this.currentPage,page_size:this.pageSize,search:this.searchHeaderForm.find},t=await(0,w.yw)(e);200===t.data.code&&(t.data.data?(this.total=t.data.data.count,null==t.data.data.data?this.tableData=[]:this.tableData=t.data.data.data):(this.total=t.data.data.count,this.tableData=[]))},onupdate(){this.operaDialog=!0,this.operaForm={...this.course},this.operaForm.teacher_id=sessionStorage.getItem("user_id")},submitForm(){(0,w.Z9)(this.operaForm).then((e=>{200!=e.data.code?this.$message.error(e.data.msg):(this.getUserMessage(),this.$message({showClose:!0,message:"修改成功",type:"success"}),this.operaDialog=!1)}))},exit(e){var t={student_id:e,course_id:this.course._id};(0,w.zd)(t).then((e=>{200!=e.data.code?this.$message.error(e.data.msg):(this.getUserMessage(),this.$message({showClose:!0,message:"踢出成功",type:"success"}),this.getDatas())}))},async getRoleMessage(){this.options1=[];const e={course_id:this.$route.query.course_id,page:this.currentPage,page_size:this.pageSize,search:this.searchHeaderForm.find},t=await(0,w.vm)(e);if(200===t.data.code)if(t.data.data){this.total=t.data.data.count,null==t.data.data.data?this.tableDataRole=[]:this.tableDataRole=t.data.data.data;for(let e=0;e<this.tableDataRole.length;e++){var a={value:this.tableDataRole[e]._id,label:this.tableDataRole[e].name};this.options1.push(a)}}else this.total=t.data.data.count,this.tableDataRole=[]},resetFormCrouse(){this.operaDialog=!1},resetFormRole(){this.roleDialog=!1},managerRole(){this.getRoleMessage(),this.isRoleManage=!0},managerStudent(){this.getDatas(),this.isRoleManage=!1},submitAddRole(){this.roleDialog=!0,this.dialogTitle="新增角色",this.roleOpera="add"},submitUpdateRole(e,t){this.roleDialog=!0,this.dialogTitle="修改角色",this.operaRoleForm={...t},this.roleOpera="update"},addRole(){var e={course_id:this.course._id,name:this.operaRoleForm.name};(0,w.hJ)(e).then((e=>{200!=e.data.code?this.$message.error(e.data.msg):(this.$message({showClose:!0,message:"创建成功",type:"success"}),this.getRoleMessage()),this.roleDialog=!1,this.operaRoleForm={}}))},updateRole2(){(0,w.Q1)(this.operaRoleForm).then((e=>{200!=e.data.code?this.$message.error(e.data.msg):(this.$message({showClose:!0,message:"修改成功",type:"success"}),this.getRoleMessage()),this.roleDialog=!1,this.operaRoleForm={}}))},deleteRole(e){(0,w.eb)({_id:e}).then((e=>{200!=e.data.code?this.$message.error(e.data.msg):(this.$message({showClose:!0,message:"删除成功",type:"success"}),this.getRoleMessage()),this.roleDialog=!1}))},upFunctions(e){this.drawer=!0,this.functonsTreeIds=e.functions,this.$nextTick((()=>{this.$refs.functionTree.setCheckedKeys(this.functonsTreeIds)})),this.updateRole=e},upFunctionsEnter(){const e=[],t=this.$refs.functionTree.getCheckedNodes();t.forEach((t=>{t.functions||e.push(t._id)})),this.updateRole.functions=e,(0,w.Q1)(this.updateRole).then((e=>{200===e.data.code?this.$message({showClose:!0,message:"权限设置成功",type:"success"}):this.$message({showClose:!0,message:"权限设置失败",type:"error"}),this.getDatas()}))},getAllFunctions(){(0,w.DT)().then((e=>{200===e.data.code&&(this.treedata=this.buildApiTree(e.data.data))}))},buildApiTree(e){return e&&e.forEach((e=>{e.name=e.group+"组"})),e},submitRoleForm(){this.$refs.operaRoleForm.validate((e=>{e?"add"===this.roleOpera?this.addRole():this.updateRole2():this.$message({showClose:!0,message:"请根据要求将信息填写完整",type:"warning"})}))},changeRole(e,t){var a={role_id:e,_id:t};(0,w.yT)(a).then((e=>{200===e.data.code?this.$message({showClose:!0,message:"修改成功",type:"success"}):this.$message({showClose:!0,message:"修改失败",type:"warning"})}))},uploadfileSuccess(){this.getDatas(),this.studentDialog=!1},importStudent(){this.studentDialog=!0}}},k=a(89);const y=(0,k.Z)(_,[["render",f],["__scopeId","data-v-1d22ca34"]]);var W=y}}]);
//# sourceMappingURL=1.188668d9.js.map